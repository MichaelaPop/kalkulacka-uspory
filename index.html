<!doctype html>
<html lang="cs">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Kalkulaƒçka √∫spor ‚Äì Alcasys</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet" />
<style>
:root{
  --text:#0f172a; --muted:#667085; --accent:#2563eb; --accent-d:#1e40af; --ring:rgba(37,99,235,.35);
  --card:#ffffff; --ok:#16a34a; --err:#dc2626;
}
/* Jemn√Ω modr√Ω gradient; ≈æ√°dn√Ω ‚Äûnucen√Ω‚Äú scrollbar */
html,body{
  margin:0; min-height:100vh; font-family:'Inter',system-ui,-apple-system,Segoe UI,Roboto,sans-serif;
  color:var(--text);
  background:
    radial-gradient(80% 120% at 0% 0%, #eaf2ff 0%, transparent 60%),
    radial-gradient(80% 120% at 100% 0%, #f0f6ff 0%, transparent 60%),
    linear-gradient(180deg,#f7faff 0%, #ffffff 60%);
  background-attachment: local; font-size:17px; line-height:1.6;
}
.wrap{max-width:860px;margin:32px auto;padding:0 16px}
/* Karta se ‚Äûsklenƒõn√Ωm‚Äú horn√≠m gradient borderem */
.card{position:relative;background:var(--card);border-radius:22px;box-shadow:0 18px 48px rgba(2,6,23,.12);padding:22px 22px 18px}
.card::before{content:"";position:absolute;inset:0 0 auto 0;height:3px;border-radius:22px 22px 0 0;background:linear-gradient(90deg,#60a5fa,#2563eb,#7c3aed);opacity:.9}
/* Progress bar */
.progress{height:8px;background:#e9eef9;border-radius:999px;overflow:hidden;margin:6px 0 16px}
.progress>span{display:block;height:100%;width:33.333%;background:linear-gradient(90deg,#60a5fa,#2563eb);transition:width .25s ease}
/* Sloupec pro pole */
.form-narrow{max-width:480px;margin:0 auto}
/* Typografie */
h1{margin:0 0 8px;font-size:24px}
.sub{margin:0 0 16px;color:var(--muted);font-size:15px}
/* Kompaktn√≠ pole */
.grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 10px;
}

@media (max-width: 768px) {
  .grid {
    grid-template-columns: 1fr;
  }
}
label{display:block;margin:2px 0 4px;font-weight:600;font-size:14px}
input,select,textarea{
  width:100%; font:inherit; font-size:15px; padding:8px 10px;
  border:1.6px solid #c9d5ee; border-radius:12px; background:#f9fbff;
  transition:border-color .15s,box-shadow .15s,background .15s,transform .05s;
}
input:hover,select:hover,textarea:hover{border-color:#b5c6ee}
input:focus,select:focus,textarea:focus{outline:0;border-color:var(--accent);box-shadow:0 0 0 3px var(--ring);background:#fff}
input[type="number"]{appearance:textfield}
textarea{min-height:90px;resize:vertical}
/* CTA ‚Äì vy≈°≈°√≠, vycentrovan√©, text dr≈æ√≠ m√≠ru */
.row-actions{display:flex;justify-content:center;margin-top:14px}
button{
  appearance:none;border:0;border-radius:14px;background:var(--accent);color:#fff;font-weight:700;
  padding:14px 18px; cursor:pointer; transition:background .15s,transform .05s;
  box-shadow:0 10px 22px rgba(37,99,235,.25); width:auto; min-width:160px; max-width:240px;
  font-size:clamp(15px,1.6vw,17px);
}
button:hover{background:var(--accent-d)} button:active{transform:translateY(1px)}
button.secondary{background:#e7eefc;color:var(--accent);box-shadow:none}
button.secondary:hover{background:#dbe6ff}
/* Stavy + animace */
.hidden{display:none!important}
.note{margin-top:10px;font-size:14px}
.ok{color:var(--ok)} .err{color:var(--err)}
.hp{position:absolute;left:-10000px;opacity:0}
.step{opacity:0;transform:translateY(8px);transition:opacity .18s ease,transform .18s ease}
.step.show{opacity:1;transform:translateY(0)}
/* Hezƒç√≠ dƒõkovac√≠ str√°nka */
.thanks{text-align:center;padding:14px 0}
.thanks h1{font-size:28px;margin-bottom:10px}
.thanks .sub{font-size:16px;margin-bottom:8px}
@media (max-width:560px){ .form-narrow{max-width:100%} .card{padding:18px} h1{font-size:22px} }
</style>
</head>
<body>
<div class="wrap">
  <div class="card">
    <div class="progress"><span id="progress-bar" style="width:33.333%"></span></div>

    <!-- KROK 1 -->
    <section id="step1" class="step show">
      <div class="form-narrow">
        <h1>Zjistƒõte, kolik m≈Ø≈æete u≈°et≈ôit d√≠ky na≈°emu ≈ôe≈°en√≠ pro kontaktn√≠ centra.</h1>
        <p class="sub">ƒå√≠m v√≠ce √∫daj≈Ø vypln√≠te, t√≠m p≈ôesnƒõj≈°√≠ v√Ωpoƒçet z√≠sk√°te.</p>

        <div class="grid">
          <div><label for="agents_total">Kolik agent≈Ø m√° va≈°e kontaktn√≠ centrum?</label><input id="agents_total" name="agents_total" type="number" min="0"></div>
          <div><label for="monthly_cost">Jak√© jsou va≈°e mƒõs√≠ƒçn√≠ n√°klady na technologii? <em>(v Kƒç)</em></label><input id="monthly_cost" name="monthly_cost" type="number" min="0" step="1"></div>
          <div><label for="calls_in_month">Kolik p≈ô√≠choz√≠ch hovor≈Ø vy≈ô√≠d√≠te mƒõs√≠ƒçnƒõ?</label><input id="calls_in_month" name="calls_in_month" type="number" min="0"></div>
          <div><label for="avg_in_sec">Jak dlouho trv√° pr≈Ømƒõrn√Ω p≈ô√≠choz√≠ hovor? <em>(v sekund√°ch)</em></label><input id="avg_in_sec" name="avg_in_sec" type="number" min="0"></div>
          <div><label for="calls_out_month">Kolik odchoz√≠ch hovor≈Ø uskuteƒçn√≠te mƒõs√≠ƒçnƒõ?</label><input id="calls_out_month" name="calls_out_month" type="number" min="0"></div>
          <div><label for="avg_out_sec">Jak dlouho trv√° pr≈Ømƒõrn√Ω odchoz√≠ hovor? <em>(v sekund√°ch)</em></label><input id="avg_out_sec" name="avg_out_sec" type="number" min="0"></div>
          <div>
            <label for="use_nonvoice">Pou≈æ√≠v√°te i jin√© ne≈æ hlasov√© kan√°ly? <em>(chat, e-mail, soci√°ln√≠ s√≠tƒõ‚Ä¶)</em></label>
            <select id="use_nonvoice" name="use_nonvoice">
              <option value="" selected disabled>Vyberte‚Ä¶</option>
              <option value="NE">NE</option>
              <option value="ANO">ANO</option>
            </select>
          </div>
          <div id="nonvoice_wrap" class="hidden">
            <label for="emails_month">Kolik e-mail≈Ø odbav√≠te mƒõs√≠ƒçnƒõ?</label>
            <input id="emails_month" name="emails_month" type="number" min="0">
            <label for="chats_month" style="margin-top:8px">Kolik chatov√Ωch zpr√°v mƒõs√≠ƒçnƒõ odbav√≠te?</label>
            <input id="chats_month" name="chats_month" type="number" min="0">
          </div>
        </div>

        <div class="row-actions">
          <button id="to_step2" type="button">Dal≈°√≠</button>
        </div>
      </div>
    </section>

    <!-- KROK 2 -->
    <section id="step2" class="step hidden">
      <div class="form-narrow">
        <h1>Pro v√Ωsledek pros√≠m vypl≈àte sv√© √∫daje:</h1>
        <div class="grid">
          <div><label for="full_name">Jm√©no a p≈ô√≠jmen√≠</label><input id="full_name" name="full_name"></div>
          <div><label for="company">Spoleƒçnost</label><input id="company" name="company"></div>
          <div><label for="phone">Telefon</label><input id="phone" name="phone" inputmode="tel" placeholder="+420 123 456 789"></div>
          <div><label for="reply_to">E-mail</label><input id="reply_to" name="reply_to" type="email" placeholder="nap≈ô. jana@firma.cz"></div>
        </div>

        <input class="hp" type="text" id="website" name="website" autocomplete="off" tabindex="-1" />

        <div class="row-actions">
          <button id="back_to_1" class="secondary" type="button">Zpƒõt</button>
          <button id="submit_btn" type="button">Spoƒç√≠tat</button>
        </div>
        <p id="note" class="note"></p>
      </div>
    </section>

    <!-- KROK 3 -->
    <section id="step3" class="step hidden">
      <div class="form-narrow thanks">
        <h1>üéâ Dƒõkujeme za vyplnƒõn√≠!</h1>
        <p class="sub">Nevych√°z√≠me z obecn√Ωch odhad≈Ø ani n√°hodn√Ωch ƒç√≠sel. Ka≈æd√©mu klientovi se vƒõnujeme individu√°lnƒõ a v√Ωsledky stav√≠me na re√°ln√Ωch datech.</p>
        <p class="sub">V√Ωpoƒçet va≈°ich mo≈æn√Ωch √∫spor v√°m brzy za≈°leme.</p>
        <p class="note ok" id="final_msg"></p>
      </div>
    </section>
  </div>
</div>

<!-- EmailJS SDK -->
<script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>
<script>
// ===== Tvoje EmailJS √∫daje =====
const PUBLIC_KEY   = "vt8iib1leI62JB7YV";
const SERVICE_ID   = "service_hoq963k";
const TEMPLATE_ID_INTERNAL = "template_dyuy5ss";
const TEMPLATE_ID_CONFIRM  = null;

emailjs.init({ publicKey: PUBLIC_KEY });

// Prvky
const step1 = document.getElementById('step1');
const step2 = document.getElementById('step2');
const step3 = document.getElementById('step3');
const toStep2Btn = document.getElementById('to_step2');
const backTo1Btn = document.getElementById('back_to_1');
const submitBtn  = document.getElementById('submit_btn');
const useNonvoice  = document.getElementById('use_nonvoice');
const nonvoiceWrap = document.getElementById('nonvoice_wrap');
const note = document.getElementById('note');
const finalMsg = document.getElementById('final_msg');
const progress = document.getElementById('progress-bar');

// Pom≈Øcky
function show(stepEl, pct){
  [step1, step2, step3].forEach(s => { s.classList.add('hidden'); s.classList.remove('show'); });
  stepEl.classList.remove('hidden'); requestAnimationFrame(()=> stepEl.classList.add('show'));
  progress.style.width = pct;
}
function v(id){ return (document.getElementById(id)?.value || '').trim(); }

// Nehlasov√© kan√°ly
useNonvoice.addEventListener('change', () => {
  const showNV = useNonvoice.value === 'ANO';
  nonvoiceWrap.classList.toggle('hidden', !showNV);
  if (!showNV){ document.getElementById('emails_month').value=''; document.getElementById('chats_month').value=''; }
});

// Kroky
toStep2Btn.addEventListener('click', () => { show(step2, '66.666%'); window.scrollTo({top:0,behavior:'smooth'}); });
backTo1Btn?.addEventListener('click', () => { note.textContent=''; show(step1, '33.333%'); window.scrollTo({top:0,behavior:'smooth'}); });

// Validace kontakt≈Ø ‚Äì povinn√Ω e-mail + telefon
function isValidEmail(email){
  return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email); // mus√≠ obsahovat ‚Äû@‚Äú a dom√©nu
}
// Povolen√© form√°ty: 123456789 | 123 456 789 | +CCC123456789 | +CCC 123 456 789  (C=1‚Äì3 ƒç√≠slice)
function isValidPhone(phone){
  const p = phone.replace(/\s{2,}/g,' ').trim();
  const re = /^(?:\d{3}\s?\d{3}\s?\d{3}|\+\d{1,3}\s?\d{3}\s?\d{3}\s?\d{3}|\+\d{1,3}\s?\d{9})$/;
  return re.test(p);
}

// EmailJS payload
function collectPayload(){
  return {
    agents_total: v('agents_total'),
    calls_in_month: v('calls_in_month'),
    calls_out_month: v('calls_out_month'),
    avg_out_sec: v('avg_out_sec'),
    avg_in_sec: v('avg_in_sec'),
    monthly_cost: v('monthly_cost'),
    use_nonvoice: v('use_nonvoice') || 'NEUVEDENO',
    emails_month: v('emails_month'),
    chats_month: v('chats_month'),
    full_name: v('full_name'),
    company: v('company'),
    phone: v('phone'),
    reply_to: v('reply_to')
  };
}

// Odesl√°n√≠
submitBtn.addEventListener('click', async () => {
  note.textContent = '';
  if (document.getElementById('website').value){ return; } // honeypot

  const email = v('reply_to');
  const phone = v('phone');

  if (!email){
    note.textContent = 'Vypl≈à pros√≠m e-mail.';
    note.className = 'note err';
    document.getElementById('reply_to').focus();
    return;
  }
  if (!isValidEmail(email)){
    note.textContent = 'Zadej pros√≠m platn√Ω e-mail (mus√≠ obsahovat ‚Äû@‚Äú).';
    note.className = 'note err';
    document.getElementById('reply_to').focus();
    return;
  }
  if (!phone){
    note.textContent = 'Vypl≈à pros√≠m telefon.';
    note.className = 'note err';
    document.getElementById('phone').focus();
    return;
  }
  if (!isValidPhone(phone)){
    note.textContent = 'Telefon zadej ve form√°tu 123456789, 123 456 789, +420123456789 nebo +420 123 456 789.';
    note.className = 'note err';
    document.getElementById('phone').focus();
    return;
  }

  submitBtn.disabled = true; submitBtn.textContent = 'Odes√≠l√°m‚Ä¶';

  try{
    await emailjs.send(SERVICE_ID, TEMPLATE_ID_INTERNAL, collectPayload());
    if (TEMPLATE_ID_CONFIRM && email){ await emailjs.send(SERVICE_ID, TEMPLATE_ID_CONFIRM, collectPayload()); }
    show(step3, '100%'); finalMsg.textContent = 'Formul√°≈ô byl √∫spƒõ≈°nƒõ odesl√°n.';
  }catch(err){
    console.error(err);
    note.textContent = 'Odesl√°n√≠ se nepoda≈ôilo. Zkuste to pros√≠m znovu.';
    note.className = 'note err';
  }finally{
    submitBtn.disabled = false; submitBtn.textContent = 'Spoƒç√≠tat';
  }
});
</script>
</body>
</html>
